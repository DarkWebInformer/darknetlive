
<!-- Mirrored from darknetlive.com/post/hacker-factor-on-snowflake-pluggable-transports-8c0fc5f8 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 05 Mar 2024 21:22:24 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1"/><title>Hacker Factor on Snowflake Pluggable Transports | Darknetlive</title><meta name="description" content="I missed this from earlier when Dr. Neal Krawetz [url=https://archive.is/vO2Ue]posted[/url] his entry titled “Tor 0day: Snowflake.” I will include the relevant"/><link rel="icon" href="../favicon.ico" sizes="any"/><meta http-equiv="onion-location" content="http://darknetlidvrsli6iso7my54rjayjursyw637aypb6qambkoepmyq2yd.onion/"/><link rel="sitemap" href="../sitemap-index.xml" type="application/xml"/><meta name="language" content="English"/><link rel="stylesheet" href="../css/styles.min.css"/></head><body><nav><a class="logo" href="../index.html"><div><img src="../logo.png" width="40" height="40"/><img src="../logo.png" width="40" height="40"/></div><label>DarkNetLive</label></a><hr/><div class="menu"><a href="../about.html">About / Contact</a><a href="../markets.html">Darknet Markets</a><a href="../onions.html">Onion Links</a><a href="../tags.html">Article Tags</a></div><form class="search" method="get" action="https://duckduckgo.com/" target="_blank"><div class="search-box"><input type="hidden" name="sites" value="darknetlive.com"/><input type="text" name="q" placeholder="Search…"/></div><button type="submit"><img src="../search.png" width="24" height="24"/></button></form></nav><div class="breadcrumb"><div><a href="../index.html">Home</a></div><div><a href="../index.html">Posts</a></div><div><label>This Page</label><label>Hacker Factor on Snowflake Pluggable Transports</label></div></div><main><h1>Hacker Factor on Snowflake Pluggable Transports</h1><div class="note mt-2">~6 min read | Published on 2021-12-31, tagged&nbsp;<a class="link" href="../tags/General-News.html">General-News</a>,&nbsp;<a class="link" href="../tags/Tor.html">Tor</a> using 1327 words.</div><hr/><div class="bbcode">I missed this from earlier when Dr. Neal Krawetz <a class="link" href="https://archive.is/vO2Ue" target="_blank">posted</a> his entry titled “Tor 0day: Snowflake.” I will include the relevant part about detecting snowflake below. The other parts of his article cover the other issues with Tor covered in his previous blog posts as well as Nusenu’s discovery of <a class="link" href="who-is-responsible-for-running-hundreds-of-malicious-tor-relays/index.html" target="_blank">an entity running hundreds of malicious Tor relays</a>.<br>I also included a bit about Snowflake for those who are unaware.<br><span class="font-bold">What is Snowflake? </span><br><br>Per <a class="link" href="https://archive.is/ORUHY" target="_blank">the Tor Project</a>:<br>Snowflake is a pluggable transport that uses a combination of domain fronting and peer-to-peer WebRTC connections between clients and volunteers to circumvent Internet censorship. Snowflake, which is the spiritual successor to flashproxy, aims to lower the barrier for running anti-censorship proxies, resulting in a large pool of proxies for users to connect to. Instead of requiring a server with consistent up-time, Snowflake proxies run as an addon or extension in your browser. These proxies can move locations as users connect to different networks, providing a moving target that is more difficult to block. We currently have about 8 thousand available Snowflake proxies each day. When a user connects to Snowflake in order to circumvent censorship, they are matched with a currently available proxy. If this proxy “melts,” or disappears, the user will be seamlessly matched with a new proxy.<br><br><img src="../images/snowflake-schematic-62017986.jpg"><p class="text-center text-gray-500">Snowflake proxies are run by volunteers.</p><br><br>Complete documentation is <a class="link" href="https://archive.is/8OCZt" target="_blank">available at Kerosene.net</a> where much more information is available:<br>Snowflake is a new circumvention tool which provides access to the free and open internet. As a Pluggable Transport, it provides easy-to-use access to a censorship circumvention system such as Tor. It is inspired by and builds upon the previous work of Flashproxy. Snowflake is much like a hybrid of previous Pluggable Transports, and this document will serve as a guide for exploring this system.<br><br>[img=]The website hosting snowflake is not the snowflake proxy. The visitors are the proxy. And yes this is the same diagram.[/img]<br><br>To illustrate in the context of Tor, Snowflake allows anyone to leave a browser tab open to become an ephemeral Tor bridge. Much like the Flashproxy design, Snowflake involves a large network of highly ephemeral volunteer proxies, with the goal of outpacing the censor’s ability to block proxy IP addresses and providing a very easy to use, reliable, and hard-to-filter method of circumventing censorship. Previously, users faced difficulties in manually configuring port-forwarding, which limited adoption of older tools like Flashproxy. Snowflake addresses NAT traversal by making it automatic and not the user’s responsibility, among a number of new advantages.<br><br><span class="font-bold">Snowflake Issues </span><br><br>This is <a class="link" href="https://archive.is/vO2Ue" target="_blank">Hacker Factor</a><br>Of all of the pluggable transports that the Tor Project has released, I think snowflake is the easiest to detect. I’m not saying that the others were difficult to detect and filter. Rather, the other protocols (fte, obfs3, obfs4, meek, etc.) only had a few ways that they could be detected. Snowflake has literally dozens of trivial ways to detect it.<br><br>For example, video chats rely on a protocol called STUN (Session Traversal Utilities for NAT; network address translation). Basically, STUN identifies your external network address. This is needed to establish any kind of video chat when you use a firewall. Snowflake uses a hard-coded list of available STUN servers. The current list is:<br><br><br><li>stun.voip.blackberry.com:3478</li><li>stun:stun.altar.com.pl:3478</li><li>stun:stun.antisip.com:3478</li><li>stun:stun.bluesip.net:3478</li><li>stun:stun.dus.net:3478</li><li>stun:stun.epygi.com:3478</li><li>stun:stun.sonetel.com:3478</li><li>stun:stun.sonetel.net:3478</li><li>stun:stun.stunprotocol.org:3478</li><li>stun:stun.uls.co.za:3478</li><li>stun:stun.voipgate.com:3478</li><li>stun:stun.voys.nl:3478</li><br>When the snowflake client first starts up, it queries DNS for a randomly selected subset of these STUN servers. It looks for the hostname resolution using both IPv4 and IPv6 (DNS ‘A’ and ‘AAAA’ records). However, it doesn’t just look up the hostnames; it checks if the name is on the local network. Like most companies, my lab uses a private network behind the firewall and runs an internal DNS server. All computers on my private network use the domain name “internal.lan”. When I started snowflake, I immediately saw a set of DNS queries for the STUN servers:<br><br>Each line is one packet, and all of this happened in one second. This means that I have multiple ways to detect a Tor snowflake client before it even tries to connect to the Tor snowflake server!<br><br><br><li>A single WebRTC client typically connects to one STUN server. If you see a single client immediately lookup multiple STUN servers <span class="italic">and</span> all of the servers are in the snowflake hard-coded list, then you’ve found a Tor snowflake client.</li><li>Regular WebRTC clients do not do hostname lookups for remote STUN servers on the local network. If you see any DNS lookups for snowflake’s STUN servers on the local network (stun.epygi.com.internal.lan, stun.voipgate.com.internal.lan, etc.) then you’ve found a Tor snowflake client.</li><br>About a second later – after doing the DNS lookups – there are queries for the snowflake hard-coded domain fronting server:<br>Again, if you see any IP address that first does a DNS lookup for a snowflake STUN server and then does a lookup for the snowflake domain fronting service, then you’ve found a Tor snowflake client.<br><br>These are just 3 ways for an administrator to watch DNS in order to detect or block Tor snowflake users before they can connect to the Tor network. There are another dozen ways to detect snowflake (zero false positives, zero false negatives) if you start looking at how it uses STUN and ICE. In addition, a snowflake client can be used to identify the IP addresses of other Tor users because other Tor users provide the snowflake proxies. (The entire snowflake protocol strikes me as a project created by a group that put no consideration into how an adversary might detect or block this pluggable transport.)<br><br>I want to emphasize the warning from my earlier blog entries: If you are in a location where using Tor can result in an arrest, being tracked by government agents, or losing your job, then do <span class="font-bold">not</span> rely on snowflake for anonymity or to protect your privacy. The Tor Project provides zero solutions if you are located in a repressive location.<br><br><span class="font-bold">i2p </span><br><br>In response to a comment on one of <a class="link" href="https://archive.is/GWWNd" target="_blank">his previous posts</a> about Tor, Dr. Krawetz wrote this:<br>I’m very familiar with i2p. I won’t go near it unless someone is paying me for exploits.<br><br>My short opinion: As many problems that Tor has, i2p is substantially worse.<br><br>It is worse BECAUSE every user is also a relay. I can sit at watch the connection, allowing me to map out each user’s address. If your server is up long enough, you should see everyone eventually.<br><br>Then there are the i2p servers (like Tor’s hidden services). It’s basically a Russian ghost town with a very strong anti-muslim vibe. (Seriously – it was like every site was “Drugs! No Arabs!” but written in Russian.)<br><br>And then there are the i2p exit nodes. Tor has a problem with hostile exit nodes. i2p has a problem because there are no exit nodes. (Well, there is ONE exit node, but it’s either down or so heavily congested by everyone else that it’s unusable.)<br><br>So if you’re using i2p, you’re not accessing the Internet (no exits). You’re likely only going to internal i2p sites that cater to illegal activity – making you a suspect just for being on i2p. And since every user is a relay, I can sit and collect the network addresses of every suspect user. Yeah, that’s worse than Tor.<br><br>All of the Hacker Factor posts about Tor make me concerned about the usefulness of Tor in the long term, even if the problems described in his posts are not ones that will immediately impact the users of drug markets (which, if I had to guess, make up the majority of my readership). As for i2p, I am not particularly concerned with the Russian ghost town part or the “anti-muslim vibe” part as neither of those impact the usefulness of i2p but it is irritating that there are so few eepsites that exist for purposes unrelated to drugs. Of course, being “a suspect just for being on i2p” is not evidence of crime in a court of law in many countries but it certainly could be an issue with ISPs and whatnot. Or make you a potential target for further scrutiny by LE.<br>The full Hacker Factor post is available <a class="link" href="https://archive.is/vO2Ue" target="_blank">here</a>.<br></div></main><div class="footer"><div><label class="btn-donate" for="donate">Donate</label><a class="link-blk" href="../pgp.txt" target="_blank">PGP Key</a><a class="link-blk" href="../mirrors.txt" target="_blank">Mirrors</a><a class="link-blk" href="../canary.txt" target="_blank">Canary</a><a class="link-blk" href="../about.html" target="_blank">Contact</a><a class="link-blk" href="../index.xml">RSS</a><a class="link-blk" href="../atom.xml">Atom</a><a class="link-blk" href="../index.json">JSON</a></div><hr/><p>DarkNetLive&copy;2023</p></div><input id="donate" type="checkbox" hidden=""/><div class="donate"><div class="outer"><h2>Donate</h2><label for="donate">[&times;]</label><div class="inner"><img src="../qr-btc.png"/><div><label>Bitcoin(BTC):</label><p readonly="">bc1q3x54q4arhut3tgat90cxdhfjtdpa0ermy0qshz</p></div></div><div class="inner"><img src="../qr-xmr.png"/><div><label>Monero(XMR):</label><p readonly="">866BTBpKj16MeWdGjvSRwm2CfEQfUitzQQmFYoCna6F5fw9mCBzXw3sfNUo4R7MnLsPBhTjurrt8DYjBYPo3ZqdxKP6eC5f</p></div></div></div></div></body>